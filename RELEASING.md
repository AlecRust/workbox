# Releasing

This project uses Conventional Commits and a tag-driven GitHub Actions release workflow.

## One-time setup

- Ensure you can publish the scoped package: `@alecrust/workbox`.
- In GitHub repo settings, add Actions secret `NPM_TOKEN` with an npm publish token (public packages).

## Release steps

1. Make sure your working tree is clean and you are on `main`:
   - `git status`
   - `git switch main && git pull --ff-only`
2. Run checks locally:
   - `bun install`
   - `bun test`
   - `bun run check`
3. Bump the version in `package.json` (e.g. `0.1.0`).
4. Update `CHANGELOG.md`:
   - `git cliff -c git-cliff.toml --unreleased --tag v0.1.0 > /tmp/CHANGELOG.new.md`
   - Copy the `## [0.1.0] ...` section into `CHANGELOG.md` under `## [unreleased]`.
5. Commit the release prep:
   - `git add package.json CHANGELOG.md bun.lock`
   - `git commit -m "chore(release): prepare for v0.1.0"`
6. Create the tag:
   - `git tag -a v0.1.0 -m "v0.1.0"`
7. Push commit + tag:
   - `git push origin main`
   - `git push origin v0.1.0`

## What happens in CI

On tag push (`v*.*.*`), `.github/workflows/release.yml`:

- Runs `bun run check` and `bun test`
- Verifies `package.json` version matches the tag
- Publishes to npm (if `NPM_TOKEN` is set)
- Creates a GitHub Release with notes generated by `git-cliff`
